# =============================================================================
# CONFIGURACIÓN DE LA APLICACIÓN LARAVEL 11 - DGSUC
# =============================================================================

# -----------------------------------------------------------------------------
# CONFIGURACIÓN BÁSICA DE LARAVEL
# -----------------------------------------------------------------------------
APP_NAME="Sistema DGSUC"
APP_ENV=production
APP_KEY=base64:YOUR_APP_KEY_HERE
APP_DEBUG=false
APP_URL=https://dgsuc.uba.ar
APP_TIMEZONE=America/Argentina/Buenos_Aires
APP_LOCALE=es
APP_FALLBACK_LOCALE=en

# -----------------------------------------------------------------------------
# BASE DE DATOS PRINCIPAL (PostgreSQL)
# -----------------------------------------------------------------------------
DB_CONNECTION=pgsql
DB_HOST=postgres
DB_PORT=5432
DB_DATABASE=informes_app
DB_USERNAME=informes_user
DB_PASSWORD=STRONG_PASSWORD_HERE
DB_SCHEMA=suc_app
DB_CHARSET=UTF8
DB_COLLATION=utf8_unicode_ci

# Configuración de conexión
DB_OPTIONS="--client_encoding=UTF8"
DB_STRICT=false
DB_ENGINE=InnoDB

# -----------------------------------------------------------------------------
# CONEXIONES MAPUCHE VÍA SSH TUNNEL
# -----------------------------------------------------------------------------
# Producción Mapuche
MAPUCHE_PROD_HOST=mapuche-prod.uba.ar
MAPUCHE_PROD_PORT=5432
MAPUCHE_PROD_DATABASE=mapuche_prod
MAPUCHE_PROD_USERNAME=informes_readonly
MAPUCHE_PROD_PASSWORD=READONLY_PASSWORD_HERE
MAPUCHE_PROD_SCHEMA=mapuche,suc,public

# Backups Mensuales (configuración dinámica)
MAPUCHE_BACKUP_PATTERN=true
MAPUCHE_BACKUP_1_HOST=mapuche-backup-202501.uba.ar
MAPUCHE_BACKUP_1_PORT=5432
MAPUCHE_BACKUP_1_DATABASE=mapuche_202501

MAPUCHE_BACKUP_2_HOST=mapuche-backup-202502.uba.ar
MAPUCHE_BACKUP_2_PORT=5432
MAPUCHE_BACKUP_2_DATABASE=mapuche_202502

# -----------------------------------------------------------------------------
# CONFIGURACIÓN SSH TUNNEL
# -----------------------------------------------------------------------------
SSH_TUNNEL_ENABLED=true
MAPUCHE_SSH_HOST=mapuche.uba.ar
MAPUCHE_SSH_PORT=22
MAPUCHE_SSH_USER=tunnel_user
MAPUCHE_SSH_KEY_PATH=/root/.ssh/id_rsa
SSH_TUNNEL_PORTS=5433:mapuche-prod.local:5432,5434:mapuche-backup1.local:5432

# -----------------------------------------------------------------------------
# REDIS Y CACHE
# -----------------------------------------------------------------------------
REDIS_HOST=redis
REDIS_PASSWORD=null
REDIS_PORT=6379
REDIS_CLIENT=phpredis
REDIS_PREFIX=dgsuc_
REDIS_DB=0

# Configuración de Cache
CACHE_DRIVER=redis
CACHE_PREFIX=dgsuc_cache_
CACHE_TTL=3600

# Configuración de Sesiones
SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=true
SESSION_COOKIE=dgsuc_session
SESSION_DOMAIN=.uba.ar
SESSION_SECURE_COOKIE=true
SESSION_SAME_SITE=strict

# -----------------------------------------------------------------------------
# COLAS Y PROCESAMIENTO
# -----------------------------------------------------------------------------
QUEUE_CONNECTION=redis
QUEUE_RETRY_AFTER=3600
QUEUE_BLOCK_FOR=null
QUEUE_FAILED_DRIVER=database-uuids

# Configuración de Workers
WORKER_PROCESSES=4
WORKER_MEMORY=2048
WORKER_TIMEOUT=3600
WORKER_SLEEP=3
WORKER_MAX_TRIES=3

# Colas específicas
QUEUE_DEFAULT_TIMEOUT=3600
QUEUE_SICOSS_TIMEOUT=7200
QUEUE_REPORTS_TIMEOUT=1800
QUEUE_EMAILS_TIMEOUT=300

# -----------------------------------------------------------------------------
# PROCESAMIENTO SICOSS
# -----------------------------------------------------------------------------
SICOSS_ENABLED=true
SICOSS_MEMORY_LIMIT=8192
SICOSS_TIME_LIMIT=3600
SICOSS_BATCH_SIZE=10000
SICOSS_CHUNK_SIZE=1000
SICOSS_RETRY_ATTEMPTS=3
SICOSS_LOG_LEVEL=info

# -----------------------------------------------------------------------------
# CORREO ELECTRÓNICO
# -----------------------------------------------------------------------------
MAIL_MAILER=smtp
MAIL_HOST=smtp.uba.ar
MAIL_PORT=587
MAIL_USERNAME=dgsuc@uba.ar
MAIL_PASSWORD=MAIL_PASSWORD_HERE
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=dgsuc@uba.ar
MAIL_FROM_NAME="${APP_NAME}"
MAIL_REPLY_TO_ADDRESS=soporte@uba.ar

# -----------------------------------------------------------------------------
# AUTENTICACIÓN MICROSOFT AZURE AD
# -----------------------------------------------------------------------------
MICROSOFT_CLIENT_ID=YOUR_AZURE_CLIENT_ID
MICROSOFT_CLIENT_SECRET=YOUR_AZURE_CLIENT_SECRET
MICROSOFT_REDIRECT_URI=https://dgsuc.uba.ar/auth/microsoft/callback
MICROSOFT_TENANT_ID=YOUR_TENANT_ID
MICROSOFT_SCOPES="openid profile email"

# -----------------------------------------------------------------------------
# MONITOREO Y LOGGING
# -----------------------------------------------------------------------------
LOG_CHANNEL=stack
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=error
LOG_DAYS=30

# Sentry (opcional)
SENTRY_LARAVEL_DSN=YOUR_SENTRY_DSN
SENTRY_TRACES_SAMPLE_RATE=0.1

# -----------------------------------------------------------------------------
# SEGURIDAD
# -----------------------------------------------------------------------------
SECURE_COOKIES=true
FORCE_HTTPS=true
CORS_ALLOWED_ORIGINS=https://dgsuc.uba.ar,https://www.dgsuc.uba.ar
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# -----------------------------------------------------------------------------
# DOCKER Y PUERTOS
# -----------------------------------------------------------------------------
HTTP_PORT=80
HTTPS_PORT=443
DB_EXTERNAL_PORT=5432
REDIS_EXTERNAL_PORT=6379
XDEBUG_PORT=9003

# -----------------------------------------------------------------------------
# BACKUP Y ALMACENAMIENTO
# -----------------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=dgsuc-backups
BACKUP_S3_REGION=sa-east-1
BACKUP_S3_ENDPOINT=https://s3.sa-east-1.amazonaws.com
BACKUP_S3_ACCESS_KEY_ID=YOUR_ACCESS_KEY
BACKUP_S3_SECRET_ACCESS_KEY=YOUR_SECRET_KEY

# -----------------------------------------------------------------------------
# CONFIGURACIONES ESPECÍFICAS DE ENTORNO
# -----------------------------------------------------------------------------
# Desarrollo
DEV_XDEBUG_ENABLED=false
DEV_MAIL_DRIVER=log
DEV_CACHE_DRIVER=file

# Producción
PROD_OPCACHE_ENABLED=true
PROD_OPCACHE_MEMORY=512
PROD_OPCACHE_MAX_FILES=20000

# -----------------------------------------------------------------------------
# CONFIGURACIONES SSL
# -----------------------------------------------------------------------------
# SSL Configuracion
CERTBOT_EMAIL=admin@uba.ar
CERTBOT_DOMAIN=dgsuc.uba.ar
SSL_AUTO_RENEW=true
SSL_RENEWAL_DAYS=30

# SSL Seguridad
SSL_PROTOCOLS=TLSv1.2 TLSv1.3
SSL_CIPHERS=ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256
SSL_SESSION_TIMEOUT=1d
SSL_SESSION_CACHE_SIZE=50m