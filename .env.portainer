# /opt/dgsuc/.env
# ==========================================
# CONFIGURACIÓN PRINCIPAL - PRODUCCIÓN PORTAINER
# Optimizado para Traefik Proxy (SSL automático)
# ==========================================
APP_NAME="Sistema DGSUC"
APP_ENV=production
APP_KEY=base64:GENERAR_CON_php_artisan_key:generate  # ⚠️ REEMPLAZAR con clave real
APP_DEBUG=false
APP_URL=https://dgsuc.uba.ar

# ==========================================
# BASE DE DATOS PRINCIPAL
# ==========================================
DB_CONNECTION=pgsql
DB_HOST=postgres
DB_PORT=5432
DB_DATABASE=dgsuc_app
DB_USERNAME=dgsuc_user
DB_PASSWORD=TU_PASSWORD_SUPER_SEGURO_AQUI  # ⚠️ REEMPLAZAR con password real
DB_SCHEMA=suc_app
DB_CHARSET=UTF8

# ==========================================
# BASES DE DATOS EXTERNAS (via SSH Tunnels)
# ==========================================

# BD PRODUCCIÓN RO (puerto 5433) - Solo lectura
DB2_CONNECTION=pgsql
DB2_HOST=127.0.0.1
DB2_PORT=5433
DB2_DATABASE=dgsuc_prod
DB2_USERNAME=dgsuc_readonly
DB2_PASSWORD=PASSWORD_DB_PROD_RO
DB2_CHARSET=UTF8
DB2_SCHEMA=public,dgsuc

# BD PRODUCCIÓN RW (puerto 5435) - Lectura/escritura
DB3_CONNECTION=pgsql
DB3_HOST=127.0.0.1
DB3_PORT=5435
DB3_DATABASE=dgsuc_prod
DB3_USERNAME=dgsuc_readwrite
DB3_PASSWORD=PASSWORD_DB_PROD_RW
DB3_CHARSET=UTF8
DB3_SCHEMA=public,dgsuc

# BD TEST RO (puerto 5434) - Solo lectura
DB4_CONNECTION=pgsql
DB4_HOST=127.0.0.1
DB4_PORT=5434
DB4_DATABASE=dgsuc_test
DB4_USERNAME=dgsuc_readonly
DB4_PASSWORD=PASSWORD_DB_TEST_RO
DB4_CHARSET=UTF8
DB4_SCHEMA=public,dgsuc

# BD TEST RW (puerto 5436) - Lectura/escritura
DB5_CONNECTION=pgsql
DB5_HOST=127.0.0.1
DB5_PORT=5436
DB5_DATABASE=dgsuc_test
DB5_USERNAME=dgsuc_readwrite
DB5_PASSWORD=PASSWORD_DB_TEST_RW
DB5_CHARSET=UTF8
DB5_SCHEMA=public,dgsuc

# ==========================================
# REDIS CACHE
# ==========================================
REDIS_HOST=redis
REDIS_PASSWORD=REDIS_PASSWORD_SUPER_SEGURO  # ⚠️ REEMPLAZAR con password real
REDIS_PORT=6379
REDIS_CLIENT=phpredis
REDIS_PREFIX=dgsuc_

# ==========================================
# CACHE Y SESIONES
# ==========================================
CACHE_DRIVER=redis
SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=true
SESSION_COOKIE=dgsuc_session
SESSION_DOMAIN=.uba.ar

# ==========================================
# COLA DE TRABAJOS
# ==========================================
QUEUE_CONNECTION=redis
QUEUE_RETRY_AFTER=3600
QUEUE_BLOCK_FOR=null

# ==========================================
# CONFIGURACIÓN DE CORREO
# ==========================================
MAIL_MAILER=smtp
MAIL_HOST=smtp.uba.ar
MAIL_PORT=587
MAIL_USERNAME=dgsuc@uba.ar
MAIL_PASSWORD=PASSWORD_CORREO_AQUI
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=dgsuc@uba.ar
MAIL_FROM_NAME="Sistema DGSUC"

# ==========================================
# MICROSOFT AZURE AD (SSO UBA)
# ==========================================
MICROSOFT_CLIENT_ID=TU_AZURE_CLIENT_ID
MICROSOFT_CLIENT_SECRET=TU_AZURE_CLIENT_SECRET
MICROSOFT_REDIRECT_URI=https://dgsuc.uba.ar/auth/microsoft/callback
MICROSOFT_TENANT_ID=TU_TENANT_ID

# ==========================================
# SSH TUNNELS CONFIGURATION (4 túneles, 2 usuarios, 2 claves)
# AUTENTICACIÓN: Docker Secrets con claves SSH separadas
# USUARIOS: dgsuc_app_ro (solo lectura), dgsuc_app_rw (lectura/escritura)
# ==========================================

# Túnel 1: DB Producción (puerto 5434) - pgsql-prod-old
SSH_HOST_DBPROD=dbprod.uba.ar
SSH_USER_DBPROD=dgsuc_app_ro
SSH_PORT_DBPROD=22

# Túnel 2: DB Producción R2 (puerto 5436) - pgsql-prod
SSH_HOST_DBPRODR2=dbprodr2.uba.ar
SSH_USER_DBPRODR2=dgsuc_app_rw
SSH_PORT_DBPRODR2=22

# Túnel 3: DB Test (puerto 5433) - pgsql-2503 a pgsql-2506
SSH_HOST_DBTEST=dbtest.uba.ar
SSH_USER_DBTEST=dgsuc_app_ro
SSH_PORT_DBTEST=22

# Túnel 4: DB Test R2 (puerto 5435) - pgsql-2507 a pgsql-2512
SSH_HOST_DBTESTR2=dbtestr2.uba.ar
SSH_USER_DBTESTR2=dgsuc_app_rw
SSH_PORT_DBTESTR2=22

# ==========================================
# WORKERS CONFIGURATION
# ==========================================
WORKER_PROCESSES=6
WORKER_MEMORY=4096
WORKER_TIMEOUT=3600

# ==========================================
# SICOSS PROCESSING
# ==========================================
SICOSS_MEMORY_LIMIT=8192
SICOSS_TIME_LIMIT=3600
SICOSS_BATCH_SIZE=10000

# ==========================================
# MONITORING
# ==========================================
GRAFANA_PASSWORD=PASSWORD_GRAFANA_ADMIN
GRAFANA_ROOT_URL=http://localhost:3000

# ==========================================
# NGINX (Traefik maneja HTTPS automáticamente)
# ==========================================
# NGINX_HOST=dgsuc.uba.ar  # No necesario con Traefik

# ==========================================
# SEGURIDAD (Traefik maneja SSL/TLS)
# ==========================================
SECURE_COOKIES=true
# FORCE_HTTPS=true  # Traefik maneja redirección HTTPS

# ==========================================
# LOGGING
# ==========================================
LOG_CHANNEL=stack
LOG_DEPRECATIONS_CHANNEL=null
LOG_LEVEL=error